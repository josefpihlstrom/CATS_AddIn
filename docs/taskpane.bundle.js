/*! For license information please see taskpane.bundle.js.LICENSE.txt */
!function(){"use strict";!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function c(e,n,r){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function a(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,c){var a=r&&r.prototype instanceof f?r:f,s=Object.create(a.prototype);return i(s,"_invoke",function(n,r,o){var c,a,i,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return c=e,a=0,i=t,p.n=n,u}};function y(n,r){for(a=n,i=r,e=0;!l&&f&&!o&&e<s.length;e++){var o,c=s[e],y=p.p,d=c[2];n>3?(o=d===r)&&(i=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=t):c[0]<=y&&((o=n<2&&y<c[1])?(a=0,p.v=r,p.n=c[1]):y<d&&(o=n<3||c[0]>r||r>d)&&(c[4]=n,c[5]=r,p.n=d,a=0))}if(o||n>1)return u;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),a=s,i=d;(e=a<2?t:i)||!l;){c||(a?a<3?(a>1&&(p.n=-1),y(a,i)):p.n=i:p.v=i);try{if(f=2,c){if(a||(o="next"),e=c[o]){if(!(e=e.call(c,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,a<2&&(a=0)}else 1===a&&(e=c.return)&&e.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=t}else if((e=(l=p.n<0)?i:n.call(r,p))!==u)break}catch(e){c=t,a=1,i=e}finally{f=1}}return{value:e,done:l}}}(n,o,c),!0),s}var u={};function f(){}function s(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(i(e={},r,function(){return this}),e),y=l.prototype=f.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,i(t,o,"GeneratorFunction")),t.prototype=Object.create(y),t}return s.prototype=l,i(y,"constructor",l),i(l,"constructor",s),s.displayName="GeneratorFunction",i(l,o,"GeneratorFunction"),i(y),i(y,o,"Generator"),i(y,r,function(){return this}),i(y,"toString",function(){return"[object Generator]"}),(a=function(){return{w:c,m:d}})()}function i(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}i=function(t,e,n,r){function c(e,n){i(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(c("next",0),c("throw",1),c("return",2))},i(t,e,n,r)}function u(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var c=t.apply(e,n);function a(t){u(c,r,o,a,i,"next",t)}function i(t){u(c,r,o,a,i,"throw",t)}a(void 0)})}}function s(t,e,n){return l.apply(this,arguments)}function l(){return(l=f(a().m(function t(e,n,r){var o,c,i,u,f;return a().w(function(t){for(;;)switch(t.n){case 0:try{for(o=n.getRange(r),c=o.format.borders,i=["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"],u=0;u<i.length;u++)(f=c.getItem(i[u])).style=Excel.BorderLineStyle.continuous,f.color="black",f.weight="Thick"}catch(t){console.error("Error in applyThickOutlineBorder:",t.message)}case 1:return t.a(2)}},t)}))).apply(this,arguments)}function p(t,e,n){return y.apply(this,arguments)}function y(){return(y=f(a().m(function t(e,n,r){var o,c,i,u,f;return a().w(function(t){for(;;)switch(t.n){case 0:try{for(o=n.getRange(r),c=o.format.borders,i=["InsideHorizontal","InsideVertical"],u=0;u<i.length;u++)(f=c.getItem(i[u])).style=Excel.BorderLineStyle.continuous,f.color="gray",f.weight="Thin"}catch(t){console.error("Error in applyThinInternalBorder:",t.message)}case 1:return t.a(2)}},t)}))).apply(this,arguments)}function d(t,e,n,r){return v.apply(this,arguments)}function v(){return(v=f(a().m(function t(e,n,r,o){return a().w(function(t){for(;;)switch(t.n){case 0:try{n.getRange(r).getEntireColumn().format.columnWidth=o}catch(t){console.error("Error in setColumnWidths:",t.message)}case 1:return t.a(2)}},t)}))).apply(this,arguments)}function h(t,e,n){return g.apply(this,arguments)}function g(){return(g=f(a().m(function t(e,n,r){var o;return a().w(function(t){for(;;)switch(t.n){case 0:return(o=n.getRange(r)).load("values"),t.n=1,e.sync();case 1:return t.a(2,o.values[0][0])}},t)}))).apply(this,arguments)}function m(t,e,n,r){return b.apply(this,arguments)}function b(){return(b=f(a().m(function t(e,n,r,o){return a().w(function(t){for(;;)switch(t.n){case 0:n.getRange(r).values=[[o]];case 1:return t.a(2)}},t)}))).apply(this,arguments)}function w(t,e,n,r){return S.apply(this,arguments)}function S(){return(S=f(a().m(function t(e,n,r,o){return a().w(function(t){for(;;)switch(t.n){case 0:n.getRange(r).formulas=[[o]];case 1:return t.a(2)}},t)}))).apply(this,arguments)}function O(t,e,n,r,o,c){for(var a=new Date(n,r+1,0).getDate(),i=o.map(function(t){return t.date}),u=1;u<=a;u++){var f=new Date(n,r,u),s="".concat(n,"-").concat(String(r+1).padStart(2,"0"),"-").concat(String(u).padStart(2,"0")),l=f.toLocaleDateString("en-US",{weekday:"short"}),p=A(u-1+8),y=["Sat","Sun"].includes(l),d=i.includes(s);m(t,e,"".concat(p,"2"),l),m(t,e,"".concat(p,"3"),u),m(t,e,"".concat(p,"4"),y||d?0:8),e.getRange("".concat(p,"2:").concat(p).concat(c)).format.fill.color=y?"#D3D3D3":d?"#FF9999":"white"}for(var v=a+1;v<=31;v++){var h=A(v-1+8);m(t,e,"".concat(h,"2"),""),m(t,e,"".concat(h,"3"),""),m(t,e,"".concat(h,"4"),""),e.getRange("".concat(h,"2:").concat(h,"4")).format.fill.color="white"}}function E(t){return j.apply(this,arguments)}function j(){return(j=f(a().m(function t(n){var r,c,i,u,f,s,l;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,fetch("https://api.dagsmart.se/holidays?year=".concat(n,"&weekends=true"));case 1:if((r=t.v).ok){t.n=2;break}throw new Error("Holiday API request failed");case 2:return t.n=3,r.json();case 3:return c=t.v,t.n=4,fetch("https://api.dagsmart.se/bridge-days?year=".concat(n,"&weekends=false"));case 4:if((i=t.v).ok){t.n=5;break}throw new Error("Bridge-day API request failed");case 5:return t.n=6,i.json();case 6:return u=t.v,f=u.map(function(t){return o(o({},t),{},{name:o(o({},t.name),{},{en:"Bridge Day",sv:"Klämdag"})})}),s=[].concat(e(c),e(f)).sort(function(t,e){return new Date(t.date)-new Date(e.date)}),t.a(2,s);case 7:return t.p=7,l=t.v,console.error("Error fetching holidays and bridge-days:",l),t.a(2,[])}},t,null,[[0,7]])}))).apply(this,arguments)}function k(t,e,n,r){var o=0;e.getRange("B".concat(r)).values="Holidays",n.forEach(function(t){var n,c=null===(n=t.name)||void 0===n?void 0:n.en;if("Saturday"!==c&&"Sunday"!==c){var a,i=r+1+o;e.getRange("B".concat(i)).values=[[t.date]],e.getRange("C".concat(i)).values=[[(null===(a=t.name)||void 0===a?void 0:a.sv)||""]],o++}})}function A(t){for(var e="";t>=0;)e=String.fromCharCode(t%26+65)+e,t=Math.floor(t/26)-1;return e}function T(t,e){return I.apply(this,arguments)}function I(){return(I=f(a().m(function t(e,n){var r;return a().w(function(t){for(;;)switch(t.n){case 0:return(r=n.getUsedRange()).load("address"),t.n=1,e.sync();case 1:r.clear(Excel.ClearApplyTo.all);case 2:return t.a(2)}},t)}))).apply(this,arguments)}function B(t,e,n,r){return P.apply(this,arguments)}function P(){return(P=f(a().m(function t(e,n,r,o){var c,i;return a().w(function(t){for(;;)switch(t.n){case 0:return(c=n.getRange(r)).load("values"),t.n=1,e.sync();case 1:i=0;case 2:if(!(i<100)){t.n=4;break}if(c.values[i][0]!==o){t.n=3;break}return console.log("Found String at row ".concat(i+1)),t.a(2,i+1);case 3:i++,t.n=2;break;case 4:return console.error("String not found in column B rows 1–100."),t.a(2,null)}},t)}))).apply(this,arguments)}function G(t,e,n){return M.apply(this,arguments)}function M(){return(M=f(a().m(function t(e,n,r){return a().w(function(t){for(;;)switch(t.n){case 0:n.getRange(r).clear(Excel.ClearApplyTo.contents);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function R(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,c){var u=r&&r.prototype instanceof i?r:i,f=Object.create(u.prototype);return x(f,"_invoke",function(n,r,o){var c,i,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,n){return c=e,i=0,u=t,p.n=n,a}};function y(n,r){for(i=n,u=r,e=0;!l&&f&&!o&&e<s.length;e++){var o,c=s[e],y=p.p,d=c[2];n>3?(o=d===r)&&(u=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=t):c[0]<=y&&((o=n<2&&y<c[1])?(i=0,p.v=r,p.n=c[1]):y<d&&(o=n<3||c[0]>r||r>d)&&(c[4]=n,c[5]=r,p.n=d,i=0))}if(o||n>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),i=s,u=d;(e=i<2?t:u)||!l;){c||(i?i<3?(i>1&&(p.n=-1),y(i,u)):p.n=u:p.v=u);try{if(f=2,c){if(i||(o="next"),e=c[o]){if(!(e=e.call(c,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=c.return)&&e.call(c),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=t}else if((e=(l=p.n<0)?u:n.call(r,p))!==a)break}catch(e){c=t,i=1,u=e}finally{f=1}}return{value:e,done:l}}}(n,o,c),!0),f}var a={};function i(){}function u(){}function f(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(x(e={},r,function(){return this}),e),l=f.prototype=i.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,x(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=f,x(l,"constructor",f),x(f,"constructor",u),u.displayName="GeneratorFunction",x(f,o,"GeneratorFunction"),x(l),x(l,o,"Generator"),x(l,r,function(){return this}),x(l,"toString",function(){return"[object Generator]"}),(R=function(){return{w:c,m:p}})()}function x(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}x=function(t,e,n,r){function c(e,n){x(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(c("next",0),c("throw",1),c("return",2))},x(t,e,n,r)}function F(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function D(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var c=t.apply(e,n);function a(t){F(c,r,o,a,i,"next",t)}function i(t){F(c,r,o,a,i,"throw",t)}a(void 0)})}}function C(){var t=document.querySelector('input[name="mode"]:checked').value;"New"===t?Excel.run(function(){var t=D(R().m(function t(e){var n,r,o,c,a,i,u,f,l,y;return R().w(function(t){for(;;)switch(t.n){case 0:return console.log("Running New script..."),n=e.workbook.worksheets.getActiveWorksheet(),r=yearSelect.value,o=document.getElementById("monthSelect"),c=o.selectedIndex,t.n=1,T(e,n);case 1:p(e,n,"I2:AM18"),s(e,n,"B2:AM16"),s(e,n,"I2:AM16"),s(e,n,"B2:AM2"),s(e,n,"I2:AM4"),s(e,n,"B17:AM17"),s(e,n,"I17:AM17"),s(e,n,"I18:AM18"),s(e,n,"G18:H20"),p(e,n,"G18:H20"),d(e,n,"B:H",60),d(e,n,"F:G",100),d(e,n,"I:AM",25),m(e,n,"B2","CATS"),m(e,n,"B3","Send.CCtr"),m(e,n,"C3","ActTyp"),m(e,n,"D3","Rec.Order"),m(e,n,"E3","Trip"),m(e,n,"F3","Confirmation Text"),m(e,n,"G3","Internal Time"),m(e,n,"H3","Total"),m(e,n,"F5","Education/Training"),m(e,n,"G5","20"),m(e,n,"F6","Admin/Line work"),m(e,n,"G6","21"),m(e,n,"F7","Meetings/Events"),m(e,n,"G7","22"),m(e,n,"F8","Absence"),m(e,n,"G8","23"),m(e,n,"B17","EndOfList"),m(e,n,"G17","Remaining"),m(e,n,"G18","New Flex"),w(e,n,"H18","=SUM(I18:AM18)"),m(e,n,"G19","Saved Flex"),m(e,n,"H19","0"),m(e,n,"G20","Result"),w(e,n,"H20","=SUM(H18:H19)"),a=4;case 2:if(!(a<=17)){t.n=4;break}return i="=SUM(I".concat(a,":AM").concat(a,")"),t.n=3,w(e,n,"H".concat(a),i);case 3:a++,t.n=2;break;case 4:u=8;case 5:if(!(u<=38)){t.n=7;break}return f=A(u),l="=".concat(f,"4-SUM(").concat(f,"5:").concat(f,"16)"),t.n=6,w(e,n,"".concat(f,"17"),l);case 6:u++,t.n=5;break;case 7:return t.n=8,E(r);case 8:return y=t.v,k(0,n,y,20),O(e,n,r,c,y,18),t.n=9,e.sync();case 9:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()):"Update"===t&&(console.log("Running Update script..."),Excel.run(function(){var t=D(R().m(function t(e){var n,r,o,c,a,i,u,f,s;return R().w(function(t){for(;;)switch(t.n){case 0:return n=e.workbook.worksheets.getActiveWorksheet(),r=yearSelect.value,o=document.getElementById("monthSelect"),c=o.selectedIndex,t.n=1,B(e,n,"B1:B100","CATS");case 1:return s=t.v,a=s+3,t.n=2,B(e,n,"B1:B100","EndOfList");case 2:return i=t.v,t.n=3,G(e,n,"I".concat(a,":AM").concat(i-1));case 3:return t.n=4,E(r);case 4:return u=t.v,O(e,n,r,c,u,i+1),t.n=5,h(e,n,"H".concat(i+3));case 5:return f=t.v,m(e,n,"H".concat(i+2),f),t.n=6,G(e,n,"I".concat(i+1,":AM").concat(i+1));case 6:return t.n=7,e.sync();case 7:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()))}Office.onReady(function(t){var e,n;t.host===Office.HostType.Excel&&(document.getElementById("runButton").addEventListener("click",C),function(){for(var t=document.getElementById("yearSelect"),e=(new Date).getFullYear(),n=0;n<=5;n++){var r=e+n,o=document.createElement("option");o.value=r,o.text=r,t.appendChild(o)}}(),e=document.getElementById("monthSelect"),n=(new Date).getMonth(),["January","February","March","April","May","June","July","August","September","October","November","December"].forEach(function(t,r){var o=document.createElement("option");o.value=t,o.text=t,r===n&&(o.selected=!0),e.appendChild(o)}),document.querySelector('input[value="Update"]').checked=!0)})}()}();
//# sourceMappingURL=taskpane.bundle.js.map